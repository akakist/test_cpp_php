запуск
./test.php input.csv output.json

Результат немного отличается от вывода из ТЗ.
1. children[{}] - в ТЗ так, у меня children{}. Т.е. убран один массив, состоящий из одного элемента - другого ассоциативного массива json.
2. Я вывожу только ветку Total. Там есть еще 2 ветки с нулевым родителем, но они используются как relation. По-логике их вывод не нужен.
